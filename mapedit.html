
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>æ–¹å—åœ°å›¾</title>
  <style>
    div{
          border:2px
    }
  </style>
</head>
<body>
<div id="tatr" style= " visibility:hidden;background-color:white;opacity:0.97 ; border:2px solid #F00; position: fixed ;width:500px;left: 15%; top: 40px">
<div>å‡çº§</div>
<pre>
  <div style="border:2px solid #F00">
	<p id="ase">æ‚¨é€‰æ‹©äº†ç‚¹</p>
	è¯·è®¾ç½®æ­¤ç‚¹çš„ç»æµå’Œé˜²å¾¡æƒ…å†µ
	<button onclick="updt()">è®¾ç½®æ‰€æœ‰è€…</button>
	<button onclick="updr()">è®¾ç½®é˜²å¾¡</button>
	<p id="asee">è®¾ç½®ç»æµæŒ‡æ•°</p>
	<button onclick="updrr()">è®¾ç½®ç»æµ</button>
	<button onclick="nos()">å…³é—­</button>
  </div>
</pre>
</div>

  <div id="tat" style= " visibility:hidden;background-color:white;opacity:0.97 ; border:2px solid #F00; position: fixed ;width:500px;left: 15%; top: 40px">
	
<div style="border:2px solid #F00">
<p id="as">æ‚¨é€‰æ‹©äº†ç‚¹</p>
<p>æ‚¨æŠ•èµ„<input id="mon">å…ƒ</p>
  <p>æ‚¨ä½¿ç”¨<input id="bds">éƒ¨é˜Ÿ</p>
<button onclick="yesa()">æ˜¯</button><button onclick="nos()">å¦</button>
</div>

</div>
  <table id="mes">
	
	
	<tr>
	  <th id="playe">ç©å®¶åç§°</th>
	  <th id="mos">é‡‘å¸</th>
	  <th id="ars">éƒ¨é˜Ÿ</th>
	  <th id="lds">é¢†åœ°</th>
	</tr>
	
  </table>
  <button onclick="btn();">æ–°åœ°å›¾</button>
  <button onclick="ntern();">è®¾ç½®ç©å®¶æ•°</button>
  <button onclick="oup();">å¯¼å‡ºåœ°å›¾</button>
  <div style="left:80%;position:fixed">
	<pre
	   id="msga">
	  æ¶ˆæ¯åŒº
	 </pre>
	  
	</div>
  
<div id="dv">
<tableÂ width="80%"Â border="1"Â cellspacing="0">Â </table>
</div>
 <script></script>
  <script>
	 
function cst(code){
    var c=String.fromCharCode(code.charCodeAt(0)+code.length);  
    for(var i=1;i<code.length;i++){        
        c+=String.fromCharCode(code.charCodeAt(i)+code.charCodeAt(i-1));  
    }     
    return escape(c);
}
//å­—ç¬¦ä¸²è¿›è¡Œè§£å¯†   
function ust(code){
    code = unescape(code);        
    var c=String.fromCharCode(code.charCodeAt(0)-code.length);        
    for(var i=1;i<code.length;i++){        
        c+=String.fromCharCode(code.charCodeAt(i)-c.charCodeAt(i-1));        
    }        
    return c;
}  
window.onerror = function(errorMessage, scriptURI, lineNumber, columnNumber, errorObj) { 
    alert("é‚µå¸å†…æ ¸é”™è¯¯æç¤º\né”™è¯¯ä¿¡æ¯ï¼š" + errorMessage + "\nå‡ºé”™æ–‡ä»¶ï¼š" + scriptURI 
		  + "\nå‡ºé”™è¡Œå·ï¼š" + lineNumber +
		  "\nå‡ºé”™åˆ—å·ï¼š" + columnNumber +
		  "\né”™è¯¯è¯¦æƒ…ï¼š" + errorObj);
} ;
// ç‚¹å‡»æŒ‰é’®,åœ¨divä¸­åˆ›å»ºä¸€ä¸ªpæ ‡ç­¾
// ç¬¬äºŒç§æ–¹å¼åˆ›å»ºå…ƒç´ : å¯¹è±¡.innerHTML="æ ‡ç­¾ä»£ç åŠå†…å®¹";
var wide = 9, high = 4;
var aa,bb;
var men=1;
var sleep = function(time) {
    var startTime = new Date().getTime() + parseInt(time, 10);
    while (new Date().getTime() < startTime)
	{}
};
function msg(msgg) {
	document.getElementById("msga").innerHTML = msgg + document.getElementById("msga").innerHTML;
}
function nern() {
	ntern(men);
	disp();
	nos();
}
function updrr() {
	upa(aa, bb, men);
	disp();
	nos();
}
function upa(aa,b,id){
	
	layoutq[aa][b]+=prompt("è¯·è¾“å…¥ç»æµç­‰çº§",layout[aa][b]/2)*2;
	disp();
	msg("\n"+name[a[aa][b]]+"å‡çº§äº†ç‚¹"+aa+","+b+"çš„ç»æµ\n");
}
function updt() {
	
	var ty=prompt("è¯·è¾“å…¥æ‰€æœ‰è€…id",a[aa][bb]);
	a[aa] = rep(a[aa], bb, ty);
	disp();
	nos();
}
function updr() {
	
	layout[aa][bb]+=prompt("è¯·è¾“å…¥é˜²å¾¡ç­‰çº§",layout[aa][bb]);
	
	disp();
	nos();
}
cli = function(a, b) {
	aa = a;bb = b;
	if (layout[a][b] == -1)return;
	if (1)
	{
		document.getElementById("tatr").style.visibility = "visible" ;

		return;


	}
	else
	{
		document.getElementById("as").innerHTML = "æ‚¨è¦èŠ±è´¹" + costof(a, b, men) + "å…ƒåˆ°" + costof(a, b, men) * 2 + "å…ƒæ”»å‡»ç‚¹" + (a + 1).toString() + "," + (b + 1).toString() + "å—ï¼Ÿ";
		document.getElementById("tat").style.visibility = "visible" ;
		document.getElementById("bds").value = 0;
	}
	document.getElementById("mon").value = costof(a, b, men);
};
nos = function() {
	document.getElementById("tat").style.visibility = "hidden" ;
	document.getElementById("tatr").style.visibility = "hidden" ;

};
yesa = function() {
	nos();
	var mone=document.getElementById("mon").value;
	var bds=document.getElementById("bds").value;
	if (mone > 2 * costof(aa, bb, men) || mone < costof(aa, bb, men) || bds < 0 || bds > army[men])
	{
		msg("æ— æ•ˆçš„è¾“å…¥");
		return;
	}atackp(aa, bb, men, mone, bds);
	disp();
};
btn = function() {
if(prompt("ä¸–ç•Œä¸Šæœ€å¸…çš„ç”·äººæ˜¯è°?")=="é‚µå¸"){
alert("ç™»å½•æˆåŠŸ");
}else{
alert("é‚£æ˜¯æœ€ä¸‘çš„ç”·äºº");
return;
}
	for (i = 0;i < 99;i++)
	{
		army[i] = 0;
	}
	for (i = 0;i < 99;i++)
	{
		layoutq[i] = Array(100);
		for (j = 0;j < 99;j++)
		{
			layoutq[i][j] = 2;
		}
	}
	if (confirm("è¦åŠ è½½è‡ªå®šä¹‰åœ°å›¾å—ï¼Ÿ"))
	{
		var text = prompt("è¯·è¾“å…¥åœ°å›¾");
		if (text)
		{
			eval(text.replace(/name/g, "namer"));

		}
    }
	else init();
	wide=prompt("è¾“å…¥å®½åº¦");
	high=prompt("è¾“å…¥é«˜åº¦");
	for (i = 0;i < high;i++)
	{
	 	for (j = 1;j < wide;j++)
		{
			layout[i][j]=0;
			a[i]+="1"
		}
	}
	disp();
};
function oup(){
	var mf="pn="+pn+";";
	for (i = 0;i < high;i++)
	{
		mf+="layoutq["+i+"]=["+layoutq[i][0];
	 	for (j = 1;j < wide;j++)
		{
			mf+=","+layoutq[i][j];
		}
		mf += "];"
		mf+="layout["+i+"]=["+layout[i][0];
	 	for (j = 1;j < wide;j++)
		{
			mf+=","+layout[i][j];
		}
		mf += "];a["+i+"]=\""+a[i]+"\";";
	}
	for(i=1;i<=pn;i++){
		mf+="money["+i+"]="+money[i]+";";
		mf+="army["+i+"]="+army[i]+";";
		mf+="name["+i+"]=\""+namer[i]+"\";";
	
	}
	prompt("è¯·å¤åˆ¶ä¸‹é¢çš„åœ°å›¾æ–‡ä»¶",mf);
}
disp = function() {
	var aa=" <table width=\"80%\" border=\"1\">\n ";
	aa += "<tr>\n";

	for (j = 0;j <= wide;j++)
	{

		aa += "<th>" + j.toString() + "</th>\n";
	}
	aa += "</tr>\n";
	for (i = 0;i < high;i++)
	{
	 	aa += "<tr><th>" + (i + 1).toString() + "</th>\n";
		for (j = 0;j < wide;j++)
		{

			if (layout[i][j] >= 0)aa += "<td onclick=\"cli(" + i.toString() + "," + j.toString() + ")\" style=\"background-color:" + getc(gea(i, j)) + "\"><pre>" + layout[i][j] + "çº§é˜²å¾¡\n" +layoutq[i][j]/2+"çº§ç»æµ\n"+ namer[a[i][j]] + "</pre></td>\n";
			else if (layout[i][j] == -1)aa += "<td onclick=\"cli(" + i.toString() + "," + j.toString() + ")\" style=\"background-color:blue\">æ°´</td>\n"
		}
		aa += "</tr>\n";
	}
	aa += " </table>\n"
	document.getElementById("dv").innerHTML = aa;
	
aa="<tr> <th>ç©å®¶</th><th>é‡‘å¸</th><th>éƒ¨é˜Ÿ</th><th>é¢†åœ°</th><th>éš¾åº¦</th></tr>";
var ld=new Array(100);
	for (i = 1; i <= pn; i++)
	{
		ld[i] = 0;
	}
	for (i = 1; i <= pn; i++)
	{
		cost_t[i] = 1;
	}
	for (i = 0; i < high; i++)
	{
		for (j = 0; j < wide; j++)
		{
			if (layout[i][j] >= 0 && layout[i][j] <= 30)
			{
				ld[a[i][j]]++;
			}
		}
	}
	for (i = 1;i <= pn;i++)
	{
	 	aa += "<tr><th>" + namer[i] + "</th>\n";
		aa+="<td>"+money[i]+"</td><td>"+army[i]+"</td><td>"+ld[i]+"</td>";
		if(diff[i]==0)aa+="<td>ç©å®¶</td>";
		else aa+="<td>"+diff[i]+"<button onclick=\"chan("+i+")\">ä¿®æ”¹</button></td>";
		aa += "</tr>\n";
	}
	document.getElementById("mes").innerHTML = aa;
	
};
function chan(id){
	namer[id]=prompt("è¾“å…¥ç©å®¶åç§°",namer[id]);
	diff[id]=prompt("è¾“å…¥éš¾åº¦(å¦‚æœæ˜¯ç©å®¶åˆ™ä¸º0)",diff[id]);
	
money[id]=prompt("è¾“å…¥åˆå§‹é‡‘å¸æ•°",money[id]);
	army[id]=prompt("è¾“å…¥åˆå§‹éƒ¨é˜Ÿæ•°",army[id]);
	disp();
}
var a= new Array(100);
var saf= new Array(100);
function gea(aa, b) {
	if (aa < 0 || b < 0 || aa > high || b > wide)return 0;
	return a[aa][b];
};
namer = new Array(100);
var diff= new Array(100);
var player= new Array(100);
var playernum= new Array(100);
var money= new Array(100);
var layout= new Array(100);
var layoutq= new Array(100);
var cost_t= [ 1, 1, 1, 1, 1, 1, 1, 1 ];
var color=[
	"#BEBEBE",
	"#FF60AF",
	"#FF77FF",
	"#CA8EFF",
	"#9393FF",
	"#84C1FF",
	"#80FFFF",
	"#93FF93",
	"#FFFF6F",
	"#FFBB77",
	"#CF9E9E",
	"#95CACA",
	"#CA8EC2"
];
function getc(id) {
	return color[id];
}
var pn = 4;
var wide = 9, high = 4;
var atadx= new Array(100);
var atady= new Array(100);
var army= new Array(100);
var atadn;
function init() {
	msg("\nä¸€å·åœ°å›¾ï¼Œç®€å•éš¾åº¦å·²å¼€å§‹\né‚µå¸å†…æ ¸åŠ è½½æˆåŠŸ\n");
    money[1] = 1;
    money[2] = 1;
    money[3] = 1;
    money[4] = 1;
    a[0] = "011222333";
    a[1] = ("111222333");
    a[2] = ("111222333");
    a[3] = ("444444444");
	layout[0] = [-1,0,0,0,0,0,0,0,0];layout[1] =  [0,0,0,0,0,0,0,0,0];layout[2] =  [0,0,0,0,0,0,0,0,0];layout[3] =  [0,0,0,0,0,0,0,0,0];
    namer[1] = "player";
    namer[2] = "ç¼–ç¨‹ai";
    namer[3] = "è¯¥æ­»çš„ai";
    namer[4] = "é‚µå¼Ÿai";
    diff[1] = 0;;
    diff[2] = 1;;
    diff[3] = 1;;
    diff[4] = 1;;
    return;
}
function bd(bb, code) {
	if (bb > 0 && bb <= money[men])
	{
		msg(namer[code] + "è´­ä¹°äº†" + bb + "éƒ¨é˜Ÿ\n");
		army[code] += bb;
		money[code] -= bb;
	}
	else msg("è´­ä¹°æ— æ•ˆ\n");
}
function makar() {
	bb = Number(prompt("æ‚¨è¦è®­ç»ƒå¤šå°‘éƒ¨é˜Ÿ?ä¸€å—é’±ä¸€ä¸ªã€‚æœ€å¤šå¯ä»¥" + money[men] + "ä¸ª", money[men]));
	bd(bb, men);
}
function refresh() {
	var ld=new Array(100);
	for (i = 1; i <= pn; i++)
	{
		ld[i] = 0;
	}
	for (i = 1; i <= pn; i++)
	{
		cost_t[i] = 1;
	}
	for (i = 0; i < high; i++)
	{
		for (j = 0; j < wide; j++)
		{
			if (layout[i][j] >= 0 && layout[i][j] <= 30)
			{
				money[a[i][j]] += layoutq[i][j];
				ld[a[i][j]]++;
			}
		}
	}
	for (i = 1; i <= pn; i++)
	{

		msg(namer[i] + "å æœ‰" + ld[i].toString() + "å—åœ°\n");
	}
}
function endturn() {
	for (i = 1; i <= pn; i++)
	{
		msg(namer[i] + "è¿˜å‰©" + money[i] + "å…ƒ\n");

	}
	

}
function abs(a) {
	if (a > 0)return a;
	return -a;
}
function canj(id, x, y) {
	
	var le=99999;
	for (i = -1; i <= 1; i++)
		for (j = -1; j <= 1; j++)
			if (x + i >= 0 && i + x < high && j + y >= 0 && j + y < wide)
				if (saf[i + x][j + y]<le )
					le=saf[i+x][j+y];
	return le;
}
function canu(id, x, y) {
	if (x >= high || y >= wide)return false;
	if (costof(x, y, id) > money[id] * 2)
		return false;
	if (a[x][y] != id)
		return false;
	for (i = -1; i <= 1; i++)
		for (j = -1; j <= 1; j++)
			if (x + i >= 0 && i + x < high && j + y >= 0 && j + y < wide)
				if (a[i + x][j + y] != id)
					return true;
	return false;
}
function can(id, x, y) {
	if (x >= high || y >= wide)return false;
	if (layout[x][y] == -1)return false;
	if (costof(x, y, id) > money[id] * 2)
		return false;
	if (a[x][y] == id)
		return false;
	for (i = -1; i <= 1; i++)
		for (j = -1; j <= 1; j++)
			if (x + i >= 0 && i + x < high && j + y >= 0 && j + y < wide)
				if (a[i + x][j + y] == id)
					return true;
	return false;
}
function pf(a) {
	return a * a;
}
function abss(a) {
	if (a > 0)
		return a;
	return -a;
}

function mp(a, b) {
	var c=Array(2);
	c[0] = a;
	c[1] = b;
	return c;
}
function costof(x, y,  pe) {
//msg(x),msg(y);msg(pe);
	if (x >= high || y >= wide || x < 0 || y < 0)return 99999;
	if (gea(x, y) == pe)
	{
		return layout[x][y] * 2 + 1;
	}
	return cost_t[pe] * (layout[x][y] * 2 + 1);

}
function rand() {
	return Math.random() * 3180486 + 518846;
}
function atack(aa, b, id) {
	if (a[aa][b] == id)
	{
		if (costof(aa, b, id) <= money[id])
		{
			layout[aa][b]++;
			money[id] -= costof(aa, b, id);
		}
		else msg("é’±ä¸å¤Ÿ\n");
		return true;
	}
	var tr = Math.floor(costof(aa, b, id) * (((rand() % 10) / 10 + 1)));
	var perc = (tr - costof(aa, b, id)) / costof(aa, b, id) - layout[aa][b] / 10;
	if (tr > money[id])
	{
		msg("é’±ä¸å¤ŸğŸ˜­\n");
		return false;
	}
	var uaa=0;
	if (army[id] > 0)
	{
		uaa = Math.floor((0.9 - perc) * 100);
		if (uaa > army[id])uaa = army[id];
		if (uaa < 0)uaa = 0;
		army[id] -= uaa;
	}
	perc = perc + (uaa / 100);
	msg(namer[id] + "æŠ•èµ„" + tr + "ä»¥åŠ" + uaa + "ä¸ªéƒ¨é˜Ÿä»¥" + (perc + 0.1).toFixed(2) + "çš„æ¦‚ç‡");
	money[id] -= tr;
	if ((perc + 1) * 5 > ((rand() % 10)))
	{
		msg("æˆåŠŸæ”»å æ­¤åœ°åŒºï¼\n");
		cost_t[id] = Number(Number(cost_t[id]) + Number(tr));
		a[aa] = rep(a[aa], b, id);
		disp();
		return true;
	}
	else
	{
		msg("æœªæ”»å æ­¤åœ°åŒºï¼\n");

	};
	return true;
}
function atackp(aa, b, id, tr, uaa) {
	
	if (a[aa][b] == id)
	{
		if (costof(aa, b, id) <= money[id])
		{
			layout[aa][b]++;
			money[id] -= costof(aa, b, id);
		}
		else msg("é’±ä¸å¤Ÿ\n");
		return true;
	}
	var perc = (tr - costof(aa, b, id)) / costof(aa, b, id) - layout[aa][b] / 10;;
	if (tr > money[id])
	{
		msg("æ²¡é’±\n");
		return false;
	}
	if (uaa > army[id])uaa = army[id];
	if (uaa < 0)uaa = 0;
	army[id] -= uaa;

	perc = perc + (uaa / 100);
	msg(namer[id] + "æŠ•èµ„" + tr + "ä»¥åŠ" + uaa + "ä¸ªéƒ¨é˜Ÿä»¥" + (perc + 0.1).toFixed(2) + "çš„æ¦‚ç‡");


	money[id] -= tr;
	if ((perc + 1) * 5 > ((rand() % 10) + 1))
	{
		msg("æˆåŠŸæ”»å æ­¤åœ°åŒºï¼\n");

		cost_t[id] = Number(Number(cost_t[id]) + Number(tr));

		a[aa] = rep(a[aa], b, id);
		disp();
		return true;
	}
	else
	{
		msg("æœªæ”»å æ­¤åœ°åŒºï¼\n");

	};
	return true;
}

function rep(str, index, char) {
	return str.substring(0, index) + char + str.substring(index + 1);
}
function ntern() {
	
	pn=prompt("è®¾ç½®ç©å®¶æ•°é‡",pn);
}
function main() {
	init("4 9 4 1 1 player 0 2 1 robot 1 3 1 æœºå™¨äºº 1 4 1 é‚µå¸ 1 111222333 111222333 111222333 444444444 jjjjjjjjjj jjjjjjjjjj jjjjjjjjjj jjjjjjjjjj ");
	display();

    endturn();
	for (;;)
	{
		cost = 1;
		//  debug_input();
		ntern('1');
		refresh();
		endturn();
		display();
		getchar();
	}

}
  var fff=0;
   setInterval(function () {
	     var imgEle = document.getElementById("image");
 
       // alert(imgEle.src);
        // æ–¹å¼1.
        if (fff===0) {
            imgEle.src = "https://swssoftwareshare.gitee.io/gitee/1.png";
			fff=1;
        } else {
            imgEle.src = "https://swssoftwareshare.gitee.io/gitee/2.jpg";
			fff=0;
        }

        // æ–¹å¼2.
        // switch (imgEle.src) {
        //     case location.href.replace(/\/[^/]+$/, "") + "/img/bulbOn.gif":
        //         imgEle.src = "img/landscape.jpg";
        //         break;
        //     case location.href.replace(/\/[^/]+$/, "") + "/img/landscape.jpg":
        //         imgEle.src = "img/bulbOn.gif";
        // }
    }, 500);

</script> 
  <a href="https://swssoftwareshare.gitee.io/swswebbrowser/donate/fkdt.html"><img id="image" src="1.png" width="460" height="220"/></a>
</body>
 </html>
